{
    "description": "Autotest configuration file for dependency tree detection validation",
    "version": 1.3,
    "base_config": {
        "validate_scan_output": true,
        "_comment_validate_scan_output": "Whether to validate the scan output/exit code. Options: true | false. Default: true",
        "scan_output": {
            "_security_scan_report_conclusion": "failure",
            "_comment_security_scan_report_conclusion": "Optional. Expected scan report conclusion. Options: 'success' | 'failure'. This validates the security scan result status. If not provided, this check will not be performed.",
            "total_libs_scanned": {
                "gte": 39
            },
            "_comment_total_libs_scanned": "Expected number of libraries scanned with comparison operator. Validates that the scan processed libraries."
        },
        "validate_dependency_tree": true,
        "_comment_validate_dependency_tree": "Whether to validate the dependency tree. Options: true | false. Default: true",
        "dependency_tree": {
            "check_dependency_tree_detection_status": true,
            "_comment_check_dependency_tree_detection_status": "Whether to check if dependency tree was successfully detected. Options: true | false. Default: true",
            "expected_total_dependencies_number": {
                "gte": 35
            },
            "expected_direct_dependencies_number": {
                "eq": 32
            },
            "expected_transitive_dependencies_number": {
                "eq": 14
            },
            "_comment_expected_dependencies_number": "Optional. Expected number of dependencies with comparison operator. Operators: gt (>), gte (>=), lt (<), lte (<=), eq (==). If not provided, this check will not be performed.",
            "direct_dependencies_names_list": {
                "eq": [
                    "pip",
                    "python",
                    "xz",
                    "libzlib",
                    "libgomp",
                    "liblzma-devel",
                    "openssl",
                    "libsqlite",
                    "libuuid",
                    "libgcc",
                    "readline",
                    "setuptools",
                    "icu",
                    "libffi",
                    "ncurses",
                    "_openmp_mutex",
                    "ca-certificates",
                    "libnsl",
                    "xz-tools",
                    "liblzma",
                    "django-2.2-py3-none-any.whl",
                    "tk",
                    "xz-gpl-tools",
                    "bzip2",
                    "_libgcc_mutex",
                    "ld_impl_linux-64",
                    "requests-2.31.0-py3-none-any.whl",
                    "zstd",
                    "flask-2.2.5-py3-none-any.whl",
                    "wheel",
                    "libstdcxx",
                    "libgcc-ng"
                ]
            },
            "transitive_dependencies_names_list": {
                "eq": [
                    "itsdangerous-2.2.0-py3-none-any.whl",
                    "idna-3.11-py3-none-any.whl",
                    "sqlparse-0.5.5-py3-none-any.whl",
                    "importlib_metadata-8.5.0-py3-none-any.whl",
                    "markupsafe-2.1.5-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl",
                    "pytz-2025.2-py2.py3-none-any.whl",
                    "urllib3-2.2.3-py3-none-any.whl",
                    "click-8.1.8-py3-none-any.whl",
                    "zipp-3.20.2-py3-none-any.whl",
                    "certifi-2026.1.4-py3-none-any.whl",
                    "werkzeug-3.0.6-py3-none-any.whl",
                    "jinja2-3.1.6-py3-none-any.whl",
                    "charset_normalizer-3.4.4-cp38-cp38-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl"
                ]
            },
            "_comment_dependencies_names_list": "Optional. Check specific libraries in direct dependencies. Operators: eq (==), contains (all items from expected list in actual), in(all items from actual list in expected), nin(actual list does not contain provided libs). If not provided, this check will not be performed.",
            "validate_agent_versions": true,
            "expected_agent_version": "",
            "expected_plugin_version": "",
            "_comment_agent_versions": "Optional. Expected agent and plugin versions. If not provided, this check will not be performed."
        },
        "validate_vulnerabilities_table": true,
        "_comment_validate_vulnerabilities_table": "Whether to validate the vulnerabilities table. Options: true | false. Default: true",
        "vulnerabilities_table": {
            "check_vulnerabilities_table_structure": true,
            "expected_total_vulnerabilities_number": {
                "gte": 0
            },
            "vulnerabilities_ids_list": {
                "contains": []
            },
            "_comment_ids_names_list": "Optional. Check specific libs ids (WS-2018-0111, CVE-2021-44906). Operators: eq (==), contains (all items from expected list in actual), in(all items from actual list in expected), nin(actual list does not contain provided libs). If not provided, this check will not be performed.",
            "vulnerabilities_names_list": {
                "contains": []
            },
            "_comment_vulnerabilities_names_list": "Optional. Check specific libs names (minimist-0.0.8.tgz). Operators: eq (==), contains (all items from expected list in actual), in(all items from actual list in expected), nin(actual list does not contain provided libs). If not provided, this check will not be performed."
        },
        "validate_scanner_logs": true,
        "_comment_validate_scanner_logs": "Whether to validate scanner logs. Options: true | false. Default: false",
        "logs": {
            "check_scanner_logs": true,
            "_comment_check_scanner_logs": "Whether to check scanner logs and attach them to Report Portal. Options: true | false. Default: true",
            "expected_log_lines": [
                {
                    "operator": "eq",
                    "value": "Trying to obtain version from 8 optional sources ..."
                },
                {
                    "operator": "eq",
                    "value": "Trying version getter: PythonVersionFile"
                },
              {
                    "operator": "eq",
                    "value": "Trying version getter: ToolVersions"
                },
              {
                    "operator": "eq",
                    "value": "Trying version getter: PyprojectToml"
                },
              {
                    "operator": "eq",
                    "value": "Trying version getter: Pipfile"
                },
              {
                    "operator": "eq",
                    "value": "Trying version getter: SetupPy"
                },
               {
                    "operator": "eq",
                    "value": "Trying version getter: SetupCfg"
                },
               {
                    "operator": "eq",
                    "value": "Trying version getter: RequirementsTxt"
                },
              {
                    "operator": "eq",
                    "value": "Trying version getter: EnvironmentYml"
                },
                {
                    "operator": "eq",
                    "value": "python version set to: 3.8.16"
                },
              {
                    "operator": "eq",
                    "value": "Installing tool python@3.8.16..."
                },
              {
                    "operator": "eq",
                    "value": "Install tool python succeeded"
                },
                 {
                  "operator": "regex",
                  "value": "Found Python version \\\\\"3\\.8\\.16\\\\\" in environment\\.yml"
                },
                {
                  "operator": "regex",
                  "value": "Found Python version \\(3\\.8\\.16\\) for Pip project at .*pip_environment_yml_only"
                }
            ],
            "_comment_expected_log_lines": "Optional. List of log lines to validate. Each entry should have an 'operator' (eq or regex) and 'value' (string or regex pattern). Example: [{'operator': 'eq', 'value': 'Python version: 3.11'}, {'operator': 'regex', 'value': 'Python version: \\d+\\.\\d+'}]. If not provided, only log attachment will be performed."
        }
    }
}
